---
title: "Plotting decay functions"
author: "Pablo Rodriguez-Sanchez"
date: ""
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Plotting decay functions}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include=FALSE}
# Default chunk configuration
knitr::opts_chunk$set(echo = TRUE, 
                      eval = TRUE, 
                      fig.width=8, 
                      fig.height=6) 

# Load libraries
library(BenchmarkRecovery)
```

## Comparing decay functions

```{r simulate}
# Set the problem
## Set the times
ts <- seq(0, 15, by = 0.025)

## Set the parameters (the same for all)
offset <- 0
pert <- 5
tpert <- 0
thalf <- 3
noise <- 0.05

## The 'realistic' time series contains an extra parameter, controlling the 'dynamic' noise
sigma <- 0.1

# Generate the time series
ys_p <- piecewise(ts, offset, pert, tpert, thalf, noise)
ys_e <- exponential(ts, offset, pert, tpert, thalf, noise)
ys_r <- realistic(ts, offset, pert, tpert, thalf, noise, sigma)
```

```{r plot, echo=FALSE}
# Plot the time series
plot(ts, ys_p, 'l', col = 'black', xlab = 'time', ylab = 'state')
lines(ts, ys_e, col = 'red')
lines(ts, ys_r, col = 'blue')
legend('topright', legend = c('piecewise', 'exponential', 'realistic'),
       col = c('black', 'red', 'blue'), lty = 1, cex = 1)
```
